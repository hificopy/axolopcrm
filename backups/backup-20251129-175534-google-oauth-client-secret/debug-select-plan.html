<!doctype html>
<html>
  <head>
    <title>Debug SelectPlan</title>
    <style>
      body {
        background: #0f0510;
        color: white;
        font-family: Arial, sans-serif;
        padding: 20px;
      }
      .error {
        color: #ff6b6b;
      }
      .success {
        color: #51cf66;
      }
      .info {
        color: #74c0fc;
      }
    </style>
  </head>
  <body>
    <h1>Debug SelectPlan Page</h1>
    <div id="status"></div>

    <h2>Environment Variables</h2>
    <div id="env"></div>

    <h2>Supabase Connection</h2>
    <div id="supabase"></div>

    <h2>Test Navigation</h2>
    <button onclick="goToSelectPlan()">Go to SelectPlan</button>

    <script>
      const statusDiv = document.getElementById('status');
      const envDiv = document.getElementById('env');
      const supabaseDiv = document.getElementById('supabase');

      // Check environment variables
      const envVars = {
          'VITE_SUPABASE_URL': import.meta.env?.VITE_SUPABASE_URL,
          'VITE_SUPABASE_ANON_KEY': import.meta.env?.VITE_SUPABASE_ANON_KEY ? 'SET' : 'NOT SET',
          'MODE': import.meta.env?.MODE,
      };

      envDiv.innerHTML = Object.entries(envVars)
          .map(([key, value]) => `<div class="info">${key}: ${value}</div>`)
          .join('');

      // Test Supabase connection
      async function testSupabase() {
          try {
              const { createClient } = await import('@supabase/supabase-js');

              if (!import.meta.env?.VITE_SUPABASE_URL || !import.meta.env?.VITE_SUPABASE_ANON_KEY) {
                  supabaseDiv.innerHTML = '<div class="error">‚ùå Supabase environment variables not set</div>';
                  return;
              }

              const supabase = createClient(
                  import.meta.env.VITE_SUPABASE_URL,
                  import.meta.env.VITE_SUPABASE_ANON_KEY
              );

              supabaseDiv.innerHTML = '<div class="info">üîÑ Testing Supabase connection...</div>';

              const { data, error } = await supabase.from('users').select('count').limit(1);

              if (error) {
                  supabaseDiv.innerHTML = `<div class="error">‚ùå Supabase error: ${error.message}</div>`;
              } else {
                  supabaseDiv.innerHTML = '<div class="success">‚úÖ Supabase connection successful</div>';
              }
          } catch (error) {
              supabaseDiv.innerHTML = `<div class="error">‚ùå Error testing Supabase: ${error.message}</div>`;
          }
      }

      function goToSelectPlan() {
          window.location.href = '/select-plan';
      }

      // Run tests
      testSupabase();

      statusDiv.innerHTML = '<div class="success">‚úÖ Page loaded successfully</div>';
    </script>
  </body>
</html>
